# âœ… PÃ³s-instalaÃ§Ã£o do Debian 12 Minimal com Unbound como DNS local

---

## ðŸ” Logar no sistema recÃ©m-instalado:

```bash
ip -c a
```

Anote o IP e a interface de rede. Conecte-se via SSH/PuTTY usando o IP e o usuÃ¡rio criado durante a instalaÃ§Ã£o.

---

## ðŸ”‘ Definir senha root e logar como root:

```bash
sudo passwd root
su
```

---

## ðŸ“¦ Instalar Unbound e baixar hints:

```bash
sudo apt update
sudo apt install unbound -y
sudo wget https://www.internic.net/domain/named.root -O /var/lib/unbound/root.hints
```

---

## âš™ï¸ Criar configuraÃ§Ã£o do Unbound:

```bash
sudo nano /etc/unbound/unbound.conf.d/pi-hole.conf
```

### ConteÃºdo do arquivo:

```bash
server:
    verbosity: 0
    interface: 127.0.0.1
    port: 5335
    do-ip4: yes
    do-udp: yes
    do-tcp: yes
    do-ip6: yes
    prefer-ip6: no
    edns-buffer-size: 1232
    prefetch: yes
    num-threads: 1
    so-rcvbuf: 1m
    private-address: 192.168.0.0/16
    private-address: 169.254.0.0/16
    private-address: 172.16.0.0/12
    private-address: 10.0.0.0/8
    private-address: fd00::/8
    private-address: fe80::/10
```

---

## ðŸš€ Iniciar Unbound e testar:

```bash
sudo systemctl restart unbound
sudo dig debian.org @127.0.0.1 -p 5335
```

---

## ðŸ“¥ Atualizar e instalar pacotes essenciais:

```bash
sudo apt update
sudo apt install lighttpd nftables systemd-resolved curl btop -y
```

---

## ðŸŒ Configurar IP fixo com systemd-networkd:

```bash
sudo nano /etc/systemd/network/10-ethernet.network
```

### Substitua `enx00e04c680094` pela sua interface:

```ini
[Match]
Name=enx00e04c680094

[Network]
Address=192.168.1.99/24
Gateway=192.168.1.1
DNS=127.0.0.1
```

> âœ… Agora que o Unbound estÃ¡ funcionando, jÃ¡ usamos ele como DNS local no prÃ³prio sistema.

---

## ðŸ”§ Ativar serviÃ§os de rede modernos e configurar resolv.conf:

```bash
sudo systemctl enable systemd-networkd --now
sudo systemctl enable systemd-resolved --now
sudo ln -sf /run/systemd/resolve/resolv.conf /etc/resolv.conf
```

---

## ðŸ§ª Testar se o sistema estÃ¡ usando o Unbound:

```bash
sudo resolvectl status
```

Deve mostrar `127.0.0.1` como DNS ativo.

```bash
sudo ping google.com
sudo dig github.com
```

---

## ðŸ”¥ Configurar firewall com nftables:

```bash
sudo nano /etc/nftables.conf
```

### ConteÃºdo do arquivo:

```bash
#!/usr/sbin/nft -f

table inet filter {
    chain input {
        type filter hook input priority 0;
        policy drop;

        iif "lo" accept
        ct state established,related accept

        tcp dport {22, 53, 80, 443, 4711} accept
        udp dport {53, 67, 123, 546, 547} accept
    }

    chain forward {
        type filter hook forward priority 0;
        policy drop;
    }

    chain output {
        type filter hook output priority 0;
        policy accept;
    }
}
```

### Ativar firewall:

```bash
sudo systemctl enable nftables --now
```

---

## ðŸ§¼ Remover pacotes desnecessÃ¡rios:

```bash
sudo apt remove --purge ifupdown network-manager wpasupplicant bluetooth -y
sudo apt autoremove -y
sudo truncate -s 0 /etc/network/interfaces
```

---

ðŸ§  **Dica final:** ApÃ³s reboot, seu sistema jÃ¡ estarÃ¡ com rede moderna, firewall ativo e DNS via Unbound funcionando localmente!
